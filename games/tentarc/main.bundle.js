!function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var i=function(){function t(t,e,n){var i=this;this.onLoad=null,this.onResize=null,this.viewportX=0,this.viewportY=0,this.designedWidth=0,this.designedHeight=0,this.canvas=null,this.context2d=null,this.scale=1,this.sceneStack=[],this.objectList=[],this.lastTime=Date.now(),window.addEventListener("load",function(o){i.canvas=document.getElementById(t),i.canvas&&(i.context2d=i.canvas.getContext("2d"),i.canvas.addEventListener("mousedown",function(t){i.onMouseDown(t)})),i.designedWidth=e,i.designedHeight=n,i.onLoad&&i.onLoad(),i.refreshScreenSize()}),window.addEventListener("resize",function(t){i.refreshScreenSize()}),window.addEventListener("keydown",function(t){i.onKeyDown(t)}),window.addEventListener("keyup",function(t){i.onKeyUp(t)})}return t.prototype.redraw=function(){this.context2d&&this.context2d.clearRect(0,0,this.context2d.canvas.width,this.context2d.canvas.height)},t.prototype.pushScene=function(t){return t.setParent(null),this.sceneStack.push(t),t.onShow&&t.onShow(),this.redraw(),t},t.prototype.popScene=function(){var t=this.getCurrentScene();t&&t.onHide&&t.onHide(),this.sceneStack.pop(),this.redraw()},t.prototype.getContext2d=function(){return this.context2d},t.prototype.getDesignedWidth=function(){return this.designedWidth},t.prototype.getDesignedHeight=function(){return this.designedHeight},t.prototype.getScale=function(){return this.scale},t.prototype.gameLoop=function(){var t=this,e=(Date.now()-this.lastTime)/1e3;if(this.lastTime=Date.now(),this.context2d){this.context2d.clearRect(0,0,this.context2d.canvas.width,this.context2d.canvas.height);var n=this.getCurrentScene();if(n){n.update(e),this.objectList=[],n.traverse(this.objectList),this.objectList.sort(function(t,e){return t.getGlobalSortIndex()<e.getGlobalSortIndex()?-1:t.getGlobalSortIndex()===e.getGlobalSortIndex()&&t.getGlobalY()<=e.getGlobalY()?-1:1});for(var i=0,o=this.objectList;i<o.length;i++){var r=o[i];r.onDraw&&r.onDraw(this)}}}requestAnimationFrame(function(){t.gameLoop()})},t.prototype.refreshScreenSize=function(){this.canvas&&this.canvas.parentElement&&this.onResize&&this.onResize(this.canvas.parentElement.clientWidth,this.canvas.parentElement.clientHeight),this.recalcScreenSize()},t.prototype.recalcScreenSize=function(){if(this.canvas&&this.canvas.parentElement){var t=this.canvas.parentElement.clientWidth/this.designedWidth,e=this.canvas.parentElement.clientHeight/this.designedHeight;this.scale=Math.min(t,e),this.scale>=1?(this.scale=Math.floor(this.scale),this.context2d&&(this.context2d.canvas.width=this.designedWidth*this.scale,this.context2d.canvas.height=this.designedHeight*this.scale,this.context2d.imageSmoothingEnabled=!1)):this.context2d&&(this.context2d.canvas.width=this.designedWidth*this.scale,this.context2d.canvas.height=this.designedHeight*this.scale,this.context2d.imageSmoothingEnabled=!0)}for(var n=0,i=this.sceneStack;n<i.length;n++){var o=i[n];o.setWidth(this.designedWidth),o.setHeight(this.designedHeight)}},t.prototype.setDesignedScreenSize=function(t,e){this.designedWidth=t,this.designedHeight=e,this.recalcScreenSize()},t.prototype.setViewportPosition=function(t,e){this.viewportX=t,this.viewportY=e},t.prototype.setViewportX=function(t){this.viewportX=t},t.prototype.setViewportY=function(t){this.viewportY=t},t.prototype.getViewportX=function(){return this.viewportX},t.prototype.getViewportY=function(){return this.viewportY},t.prototype.onKeyDown=function(t){var e=this.getCurrentScene();e&&e.onKeyDown&&e.onKeyDown(t.key,t.keyCode)},t.prototype.onKeyUp=function(t){var e=this.getCurrentScene();e&&e.onKeyUp&&e.onKeyUp(t.key,t.keyCode)},t.prototype.onMouseDown=function(t){var e=t.x,n=t.y;this.canvas&&(e-=this.canvas.offsetLeft,n-=this.canvas.offsetTop),e=Math.floor(e/this.scale),n=Math.floor(n/this.scale);var i=this.getCurrentScene();if(i){var o=i.pickSceneObject(e,n);o&&o.onMouseDown&&o.onMouseDown(e-o.getGlobalX(),n-o.getGlobalY())}},t.prototype.run=function(){this.gameLoop()},t.prototype.setFillStyle=function(t){this.context2d&&(this.context2d.fillStyle=t)},t.prototype.save=function(){this.context2d&&this.context2d.save()},t.prototype.restore=function(){this.context2d&&this.context2d.restore()},t.prototype.multiplyColor=function(t){this.context2d&&(this.context2d.globalCompositeOperation="multiply",this.context2d.fillStyle=t)},t.prototype.putPixel=function(t,e,n){if(this.context2d){var i=t.getGlobalX()+e*t.getScale(),o=t.getGlobalY()+n*t.getScale(),r=t.getGlobalScale();this.context2d.fillRect((t.getPinned()?i:i-this.viewportX)*this.scale,(t.getPinned()?o:o-this.viewportY)*this.scale,r*this.scale,r*this.scale)}},t.prototype.drawRect=function(t,e,n,i,o){if(this.context2d){var r=t.getGlobalX()+e*t.getScale(),s=t.getGlobalY()+n*t.getScale(),a=t.getGlobalScale();this.context2d.fillRect((t.getPinned()?r:r-this.viewportX)*this.scale,(t.getPinned()?s:s-this.viewportY)*this.scale,i*a*this.scale,o*a*this.scale)}},t.prototype.drawImage=function(t,e,n,i,o,r,s,a){if(this.context2d){var h=t.getGlobalX()+s*t.getScale(),c=t.getGlobalY()+a*t.getScale(),u=t.getGlobalScale();this.context2d.drawImage(e.getImageElement(),n,i,o,r,(t.getPinned()?h:h-this.viewportX)*this.scale,(t.getPinned()?c:c-this.viewportY)*this.scale,o*u*this.scale,r*u*this.scale)}},t.prototype.getCurrentScene=function(){return this.sceneStack.length>0?this.sceneStack[this.sceneStack.length-1]:null},t}(),o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var s=function(){function t(t,e){this.onUpdate=null,this.onDraw=null,this.onMouseDown=null,this.onKeyDown=null,this.onKeyUp=null,this.x=0,this.y=0,this.width=0,this.height=0,this.scale=1,this.sortIndex=1,this.visible=!0,this.parent=null,this.childs=[],this.pinned=!1,this.setWidth(t),this.setHeight(e)}return t.prototype.setPosition=function(t,e){return this.x=t,this.y=e,this},t.prototype.setX=function(t){return this.x=t,this},t.prototype.setY=function(t){return this.y=t,this},t.prototype.setPinned=function(t){return this.pinned=t,this},t.prototype.getPinned=function(){return this.parent?this.pinned||this.parent.getPinned():this.pinned},t.prototype.setSize=function(t,e){return this.width=t,this.height=e,this},t.prototype.setWidth=function(t){return this.width=t,this},t.prototype.setHeight=function(t){return this.height=t,this},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t.prototype.getGlobalX=function(){return this.parent?this.x*this.scale+this.parent.getGlobalX():this.x*this.scale},t.prototype.getGlobalY=function(){return this.parent?this.y*this.scale+this.parent.getGlobalY():this.y*this.scale},t.prototype.setScale=function(t){return this.scale=t,this},t.prototype.getScale=function(){return this.scale},t.prototype.getGlobalScale=function(){return this.parent?this.scale*this.parent.getGlobalScale():this.scale},t.prototype.setSortIndex=function(t){return this.sortIndex=t,this},t.prototype.getSortIndex=function(){return this.sortIndex},t.prototype.getGlobalSortIndex=function(){return this.parent?this.sortIndex+this.parent.getGlobalSortIndex():this.sortIndex},t.prototype.setVisible=function(t){return this.visible=t,this},t.prototype.getVisible=function(){return this.visible},t.prototype.setParent=function(t){return this.parent=t,this},t.prototype.getParent=function(){return this.parent},t.prototype.addChild=function(t){return t.setParent(this),this.childs.push(t),t},t.prototype.traverse=function(t){if(this.visible){t.push(this);for(var e=0,n=this.childs;e<n.length;e++){n[e].traverse(t)}}},t.prototype.update=function(t){this.onUpdate&&this.onUpdate(t);for(var e=0,n=this.childs;e<n.length;e++){n[e].update(t)}},t.prototype.pickSceneObject=function(t,e){if(t>=this.getGlobalX()&&e>=this.getGlobalY()&&t<this.getGlobalX()+this.width&&e<this.getGlobalY()+this.height){for(var n=0,i=this.childs;n<i.length;n++){var o=i[n].pickSceneObject(t,e);if(o)return o}return this}return null},t}(),a=function(t){function e(e){var n=t.call(this,e.getDesignedWidth(),e.getDesignedHeight())||this;return n.onShow=null,n.onHide=null,n.screen=e,n}return r(e,t),e.prototype.addSceneObject=function(t){return this.addChild(t),t},e.prototype.getCurrentScreen=function(){return this.screen},e}(s),h=function(){return function(){}}(),c=function(t){function e(e){var n=t.call(this)||this;return n.image=document.createElement("img"),n.image.src=e,n.image.style.display="none",document.body.appendChild(n.image),n}return r(e,t),e.prototype.getImageElement=function(){return this.image},e.prototype.getWidth=function(){return this.image.naturalWidth},e.prototype.getHeight=function(){return this.image.naturalHeight},e}(h),u=function(t){function e(){var e=t.call(this)||this;return e.getWidth=function(t){return 0},e.getHeight=function(){return 0},e.drawGlyph=function(t,e,n,i,o,r){},e}return r(e,t),e}(h),l=function(){function t(){this.request=new XMLHttpRequest}return t.prototype.loadAsText=function(t,e){var n=this;this.request.open("get",t,!0),this.request.responseType="text",this.request.onload=function(t){n.request=t.currentTarget,n.request?e(n.request.responseText):e(null)},this.request.send()},t.prototype.loadAsBinary=function(t,e){var n=this;this.request.open("get",t,!0),this.request.responseType="arraybuffer",this.request.onload=function(t){n.request=t.currentTarget,n.request?e(n.request.response):e(null)},this.request.send()},t}(),p=function(t){function e(n,i){var o=t.call(this)||this;return o.engFont=[],o.korFont=[],o.engFontReady=!1,o.korFontReady=!1,o.getWidth=function(t){return t.charCodeAt(0)<256?8:16},o.getHeight=function(){return 16},o.drawGlyph=function(t,n,i,r,s,a){var h=a.charCodeAt(0);if(n.setFillStyle(s),o.engFontReady&&h<256)o.drawEngGlyph(t,n,i,r,h);else if(o.korFontReady){h-=44032;var c=Math.floor(Math.floor(h/28)/21)+1,u=Math.floor(h/28)%21+1,l=h%28,p=l?e.choTypeJongExist[u]:e.choType[u],d=(1===c||16===c?0:1)+(l?2:0),g=e.jongType[u];o.drawKorGlyph(t,n,i,r,20*p+c),o.drawKorGlyph(t,n,i,r,e.indexJoongStart+(22*d+u)),l&&o.drawKorGlyph(t,n,i,r,e.indexJongStart+(28*g+l))}},o.loadEnglishFont(n),o.loadKoreanFont(i),o}return r(e,t),e.prototype.loadEnglishFont=function(t){var e=this;(new l).loadAsBinary(t,function(t){if(t){for(var n=new Uint8Array(t),i=0;i<256;i++){e.engFont[i]=[];for(var o=0;o<16;o++)e.engFont[i][o]=n[16*i+o]}e.engFontReady=!0}})},e.prototype.loadKoreanFont=function(t){var e=this;(new l).loadAsBinary(t,function(t){if(t){for(var n=new Uint16Array(t),i=0;i<360;i++){e.korFont[i]=[];for(var o=0;o<16;o++)e.korFont[i][o]=n[16*i+o]}e.korFontReady=!0}})},e.prototype.drawEngGlyph=function(t,e,n,i,o){for(var r=0;r<16;r++)for(var s=0;s<8;s++)this.engFont[o][r]&128>>s&&e.putPixel(t,n+s,i+r)},e.prototype.drawKorGlyph=function(t,e,n,i,o){for(var r=0;r<16;r++){for(var s=0;s<8;s++)this.korFont[o][r]&128>>s&&e.putPixel(t,n+s,i+r);for(s=0;s<8;s++)this.korFont[o][r]&32768>>s&&e.putPixel(t,n+(s+8),i+r)}},e.choType=[0,0,0,0,0,0,0,0,0,1,3,3,3,1,2,4,4,4,2,1,3,0],e.choTypeJongExist=[0,5,5,5,5,5,5,5,5,6,7,7,7,6,6,7,7,7,6,6,7,5],e.jongType=[0,0,2,0,2,1,2,1,2,3,0,2,1,3,3,1,2,1,3,3,1,1],e.jamoTable=[1,2,0,3,0,0,4,5,6,0,0,0,0,0,0,0,7,8,9,0,10,11,12,13,14,15,16,17,18,19],e.indexJoongStart=160,e.indexJongStart=248,e}(u),d=function(t){function e(e){var n=t.call(this,0,0)||this;return n.animations=[],n.curAnimation=0,n.rect={x:0,y:0,width:0,height:0},n.onUpdate=function(t){n.animations.length>0&&n.animations[n.curAnimation].onUpdate(t)},n.onDraw=function(t){if(n.animations.length>0){var e=n.animations[n.curAnimation].getCurrentFrame();n.setWidth(e.getWidth()),n.setHeight(e.getHeight()),t.drawImage(n,n.image,e.getX(),e.getY(),e.getWidth(),e.getHeight(),0,0)}else t.drawImage(n,n.image,n.rect.x,n.rect.y,n.rect.width,n.rect.height,0,0)},n.image=e,n}return r(e,t),e.prototype.setRect=function(t,e,n,i){this.rect.x=t,this.rect.y=e,this.rect.width=n,this.rect.height=i},e.prototype.addAnimation=function(t){this.animations.push(t)},e.prototype.setAnimation=function(t){"number"==typeof t?this.curAnimation=t:"string"==typeof t&&(this.curAnimation=0)},e.prototype.getCurrentAnimation=function(){return this.curAnimation},e}(s),g=function(t){function e(e,n,i,o,r){void 0===i&&(i="white"),void 0===o&&(o=0),void 0===r&&(r=0);var s=t.call(this,o,r)||this;return s.lineHeight=1,s.onDraw=function(t){for(var e=0,n=0,i=0,o=s.text;i<o.length;i++){var r=o[i];" "===r&&0===e||("\n"===r?(e=0,n+=s.font.getHeight()*s.lineHeight):(s.font.drawGlyph(s,t,e,n,s.fontColor,r),0===s.getWidth()||e+s.font.getWidth(r)<s.getWidth()?e+=s.font.getWidth(r):(e=0,n+=s.font.getHeight()*s.lineHeight)))}},s.font=e,s.text=n,s.fontColor=i,s}return r(e,t),e.prototype.setFontColor=function(t){return this.fontColor=t,this},e.prototype.getFontColor=function(){return this.fontColor},e.prototype.setText=function(t){return this.text=t,this},e.prototype.getText=function(){return this.text},e.prototype.setLineHeight=function(t){return this.lineHeight=t,this},e.prototype.getLineHeight=function(){return this.lineHeight},e}(s),f=function(t){function e(e,n){void 0===n&&(n=16);var i=t.call(this)||this;i.audio=[],i.currentChannel=0,i.channels=n;for(var o=0;o<n;o++)i.audio[o]=document.createElement("audio"),i.audio[o].src=e,i.audio[o].style.display="none",document.body.appendChild(i.audio[o]);return i}return r(e,t),e.prototype.play=function(t){void 0===t&&(t=1),this.audio[this.currentChannel].volume=t,this.audio[this.currentChannel].play(),this.currentChannel++,this.currentChannel===this.channels&&(this.currentChannel=0)},e}(h),y=function(t){function e(e,n,i,o){var r=t.call(this)||this;return r.columns=-1,r.map=new Map,r.getWidth=function(t){return t.charCodeAt(0)>=0&&t.charCodeAt(0)<256?r.fontWidth>>1:r.fontWidth},r.getHeight=function(){return r.fontHeight},r.drawGlyph=function(t,e,n,i,o,s){var a=r.map.get(s);r.columns<0&&(r.columns=Math.floor(r.image.getWidth()/r.fontWidth)),void 0!==a&&e.drawImage(t,r.image,a%r.columns*r.fontWidth,Math.floor(a/r.columns)*r.fontHeight,r.fontWidth,r.fontHeight,n,i)},r.image=new c(e),r.fontWidth=i,r.fontHeight=o,(new l).loadAsText(n,function(t){if(t)for(var e=0;e<t.length;e++)r.map.set(t[e],e)}),r}return r(e,t),e}(u),w=function(t){function e(e,n,i,o){var r=t.call(this,e*i,n*o)||this;return r.mapLayers=[],r.collisionTypeData=[],r.mapWidth=e,r.mapHeight=n,r.tileWidth=i,r.tileHeight=o,r.drawWidth=0,r.drawHeight=0,r.tileSets=[],r}return r(e,t),e.prototype.addTileSet=function(t){return this.tileSets.push(t),this},e.prototype.getTileSets=function(){return this.tileSets},e.prototype.setDrawSize=function(t,e){return this.drawWidth=t,this.drawHeight=e,this},e.prototype.setDrawWidth=function(t){return this.drawWidth=t,this},e.prototype.setDrawHeight=function(t){return this.drawHeight=t,this},e.prototype.getDrawWidth=function(){return this.drawWidth},e.prototype.getDrawHeight=function(){return this.drawHeight},e.prototype.addLayer=function(t,e){return void 0===e&&(e=0),this.mapLayers.push(t),this.addChild(t).setSortIndex(e),this},e.prototype.getLayer=function(t){for(var e=0,n=this.mapLayers;e<n.length;e++){var i=n[e];if(i.getName()===t)return i}return null},e.prototype.setCollisionTypeData=function(t){return this.collisionTypeData=t,this},e.prototype.getTilePositionTopLeft=function(t,e){var n=Math.floor(e/this.tileHeight);return{x:Math.floor(t/this.tileWidth)*this.tileWidth,y:n*this.tileHeight}},e.prototype.getTilePositionCenter=function(t,e){var n=Math.floor(e/this.tileHeight);return{x:Math.floor(t/this.tileWidth)*this.tileWidth+this.tileWidth/2,y:n*this.tileHeight+this.tileHeight/2}},e.prototype.getCollisionType=function(t,e){var n=Math.floor(e/this.tileHeight),i=Math.floor(t/this.tileWidth);return n>=0&&i>=0&&n<this.mapHeight&&i<this.mapWidth?this.collisionTypeData[n*this.mapWidth+i]:-1},e}(s),m=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.columns=n,o.tileCount=i,o}return r(e,t),e.prototype.getColumns=function(){return this.columns},e.prototype.getTileCount=function(){return this.tileCount},e}(c),v=function(t){function e(e,n,i,o,r,s){var a=t.call(this,n*o,i*r)||this;return a.onDraw=function(t){var e=a.getParent();if(e)for(var n=a.getGlobalX(),i=a.getGlobalY(),o=t.getViewportX(),r=t.getViewportY(),s=0!==e.getDrawWidth()?e.getDrawWidth():Math.floor(t.getDesignedWidth()/a.tileWidth),h=0!==e.getDrawHeight()?e.getDrawHeight():Math.floor(t.getDesignedHeight()/a.tileHeight),c=Math.floor((o-n)/a.tileWidth),u=Math.floor((r-i)/a.tileHeight),l=c+s+2,p=u+h+2,d=e.getTileSets(),g=u;g<p;g++)for(var f=c;f<l;f++)if(!(g<0||f<0||g>=a.mapHeight||f>=a.mapWidth)){var y=a.mapData[g*a.mapWidth+f];if(y>0){y-=1;for(var w=0,m=0,v=d;m<v.length;m++){var S=v[m];y>=S.getTileCount()&&(w++,y-=S.getTileCount())}t.drawImage(a,d[w],Math.floor(y%d[w].getColumns())*a.tileWidth,Math.floor(y/d[w].getColumns())*a.tileHeight,a.tileWidth,a.tileHeight,f*a.tileWidth,g*a.tileHeight)}}},a.name=e,a.mapWidth=n,a.mapHeight=i,a.tileWidth=o,a.tileHeight=r,a.mapData=s,a}return r(e,t),e.prototype.getName=function(){return this.name},e}(s),S=function(){function t(){}return t.load=function(t,e){(new l).loadAsText(t,function(t){if(t){for(var n=JSON.parse(t),i=new w(n.width,n.height,n.tilewidth,n.tileheight),o=0,r=n.tilesets;o<r.length;o++){var s=r[o];i.addTileSet(new m(s.image,s.columns,s.tilecount))}for(var a=0,h=n.layers;a<h.length;a++){var c=h[a];"_collision"===c.name?i.setCollisionTypeData(c.data):i.addLayer(new v(c.name,n.width,n.height,n.tilewidth,n.tileheight,c.data),c.id)}e(i)}else e(null)})},t}(),x=function(){function t(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i}return t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getWidth=function(){return this.width},t.prototype.getHeight=function(){return this.height},t}(),b=function(){function t(t,e){this.frames=[],this.currentFrame=0,this.remainTime=0,this.id=t,this.duration=e}return t.prototype.addFrame=function(t){this.frames.push(t),this.remainTime=this.duration/this.frames.length},t.prototype.getCurrentFrame=function(){return this.frames[this.currentFrame]},t.prototype.onUpdate=function(t){for(this.remainTime-=t;this.remainTime<=0;)this.remainTime+=this.duration/this.frames.length,this.currentFrame++,this.currentFrame>=this.frames.length&&(this.currentFrame=0)},t}(),H=function(){function t(){}return t.load=function(t,e){(new l).loadAsText(t,function(t){if(t){for(var n=JSON.parse(t),i=new c(n.image),o=new d(i),r=0,s=n.animations;r<s.length;r++){for(var a=s[r],h=new b(a.id,a.duration),u=0,l=a.frames;u<l.length;u++){var p=l[u];h.addFrame(new x(p.x,p.y,p.width,p.height))}o.addAnimation(h)}e(o)}else e(null)})},t}(),C=function(t){function e(e,n,i){var o=t.call(this,e,n)||this;return o.color="white",o.onDraw=function(t){t.setFillStyle(o.color),t.drawRect(o,0,0,o.getWidth(),o.getHeight())},o.color=i,o}return r(e,t),e}(s),W=function(t){function e(e){var n=t.call(this,e)||this;return n.keyDown=[],n.map=null,n.sprite=null,n.npc=null,n.talk=null,n.stepCount=1,n.onShow=function(){},n.onHide=function(){},n.onUpdate=function(t){if(n.map&&n.sprite){var e=n.sprite.getX(),i=n.sprite.getY();n.keyDown[37]?(n.sprite.setX(e-2),n.sprite.setAnimation(3),n.stepCount--):n.keyDown[38]?(n.sprite.setY(i-2),n.sprite.setAnimation(2),n.stepCount--):n.keyDown[39]?(n.sprite.setX(e+2),n.sprite.setAnimation(1),n.stepCount--):n.keyDown[40]?(n.sprite.setY(i+2),n.sprite.setAnimation(0),n.stepCount--):n.stepCount=1,n.stepCount<=0&&(n.step.play(),n.stepCount=24),0===n.map.getCollisionType(n.sprite.getX()+2,n.sprite.getY()+18)&&0===n.map.getCollisionType(n.sprite.getX()+14,n.sprite.getY()+18)&&0===n.map.getCollisionType(n.sprite.getX()+2,n.sprite.getY()+30)&&0===n.map.getCollisionType(n.sprite.getX()+14,n.sprite.getY()+30)||(n.sprite.setX(e),n.sprite.setY(i)),n.getCurrentScreen().setViewportX(n.sprite.getGlobalX()-128),n.getCurrentScreen().setViewportY(n.sprite.getGlobalY()-128)}},n.onKeyDown=function(t,e){n.keyDown[e]=!0,32===e&&n.talk&&n.talk.setVisible(!n.talk.getVisible())},n.onKeyUp=function(t,e){n.keyDown[e]=!1},n.onMouseDown=function(t,e){n.getCurrentScreen().popScene()},n.fnt=new y("h04.png","charList.txt",16,16),n.bgm=new f("./hotel.mp3"),n.bgm.play(.25),n.step=new f("./ui-sound-14.ogg"),S.load("./tilemap.json",function(t){if(t){n.addSceneObject(t),n.map=t;var e=n.map.getLayer("ground");e&&e.setSortIndex(0);var i=n.map.getLayer("object_under_character");i&&i.setSortIndex(1);var o=n.map.getLayer("object_over_character");o&&o.setSortIndex(3),t.setDrawSize(16,16),n.addSceneObject(new C(224,270,"black")).setX(272).setPinned(!0).setSortIndex(10)}}),H.load("hero.json",function(t){n.sprite=t,t&&n.addSceneObject(t).setPosition(300,256).setSortIndex(2)}),H.load("npc.json",function(t){n.npc=t,t&&n.addSceneObject(t).setPosition(384,330).setSortIndex(2)}),n.talk=new C(240,72,"#00000080"),n.talk.setPosition(16,16),n.talk.setPinned(!0),n.addSceneObject(n.talk).setPosition(16,16).setSortIndex(20).addChild(new g(n.fnt,"[장경돌]\n안녕하세용~ 저는 장경돌 입니다^^;; 반갑습니다.\n여러분의 성원에 힘입어 이렇게 게임을 만들게 되었습니다. 가나다라마바사아자차카타파하 에헤 우헤우헤우허허 하고싶은 말들은 너무너무 많은데.","white").setLineHeight(1.5).setScale(.5).setPosition(16,16).setSize(448,112)),n.talk.setVisible(!1),n}return r(e,t),e}(a),D=function(t){function e(e){var n=t.call(this,e)||this;return n.sprite=null,n.onShow=function(){n.sprite=new d(n.chr);var t=new b("walk-down",1);t.addFrame(new x(0,0,16,32)),t.addFrame(new x(16,0,16,32)),t.addFrame(new x(32,0,16,32)),t.addFrame(new x(48,0,16,32));var e=new b("walk-right",1);e.addFrame(new x(0,32,16,32)),e.addFrame(new x(16,32,16,32)),e.addFrame(new x(32,32,16,32)),e.addFrame(new x(48,32,16,32));var i=new b("walk-up",1);i.addFrame(new x(0,64,16,32)),i.addFrame(new x(16,64,16,32)),i.addFrame(new x(32,64,16,32)),i.addFrame(new x(48,64,16,32));var o=new b("walk-left",1);o.addFrame(new x(0,96,16,32)),o.addFrame(new x(16,96,16,32)),o.addFrame(new x(32,96,16,32)),o.addFrame(new x(48,96,16,32)),n.sprite&&(n.sprite.addAnimation(t),n.sprite.addAnimation(e),n.sprite.addAnimation(i),n.sprite.addAnimation(o),n.addSceneObject(n.sprite).setPosition(64,64)),n.addSceneObject(new g(n.fnt,"ABCD1234ab\ncd!!")).setPosition(0,16),n.addSceneObject(new g(n.fnt,"Hello~! 반가워!","yellow",48,16)).setPosition(0,48)},n.onHide=function(){},n.onKeyDown=function(t,e){n.sprite&&(3===n.sprite.getCurrentAnimation()?n.sprite.setAnimation(0):n.sprite.setAnimation(n.sprite.getCurrentAnimation()+1))},n.onMouseDown=function(t,e){n.getCurrentScreen().pushScene(new W(n.getCurrentScreen()))},n.chr=new c("character.png"),n.fnt=new p("HMDEF.ENG","H04.HAN"),n}return r(e,t),e}(a),F=new i("canvas",480,270);F.onLoad=function(){F.pushScene(new D(F))},F.run()}]);